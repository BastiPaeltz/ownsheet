"use strict";function initializeMasonry(){{var e=document.querySelector("#masonry-container");new Masonry(e,{columnWidth:50,itemSelector:".box"})}}function customizePage(e){var t=[],n=e.get("colors");if(n)for(var o in n)t.push(n[o].code);else t=["#2d9f34","#4b65c3","#48456a","#4f7a4e","#d61115","#59582f"];var r=e.get("box-size")||250;$(".box").each(function(e){$(this).css("width",r+"px"),$(this).css("background-color",t[e%t.length])}),$("a").each(function(){this.target="_blank"}),$("img").each(function(){$(this).remove()}),$("pre").before('<button class="pre-button" >Show/Hide code block</button>'),$(".pre-button").click(function(){$(this).next().find("code").toggle(),initializeMasonry()});var i=e.get("background-color");i&&$("html, body").css("background-color",i),initializeMasonry()}function renderContent(e,t){var n=document.getElementById("ms-content");n.innerHTML=t.parse(e)+"</div></div>"}function startSpinner(){var e={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},t=document.getElementById("ms-content"),n=new Spinner(e).spin(t);return n}var ownsheetApp=angular.module("ownsheetApp");ownsheetApp.controller("viewController",["$scope","$window","$routeParams","$sce","chromeStorageService","mdParserService","previewContentService","localStorageService",function(e,t,n,o,r,i,s,a){var c,h=n.sheetName;e.sheet={};var d=startSpinner();if(!h&&t.location.href.endsWith("main.html#/preview")){e.sheet.name="preview",e.mode="preview",e.sheet.message="";var l=s.get();l.then(function(t){e.mdContent=t,e.mdContent?(renderContent(e.mdContent,i),customizePage(a),e.buttonType="edit"):(d.stop(),e.sheet.message="No preview here",e.buttonType="new")}),window.onbeforeunload=function(){return"If you leave this page, changes on your sheet you were just editing, will be lost."}}else e.sheet.name=h,e.sheet.message="",c=r.getFromStorage(h),c.then(function(t){t[h]?(renderContent(t[h].content,i),customizePage(a),e.buttonType="edit"):(d.stop(),"Error"===t?e.sheet.message="Storage error! Please open ownsheet again. If this problem persists, consider contacting the developer.":(e.sheet.name="",e.sheet.message="No sheet here. Do you want to add one?",e.buttonType="new"))});document.title=e.sheet.name+" cheat sheet",this.goToEdit=function(){"preview"!==e.mode?t.open("main.html#/edit/"+e.sheet.name,"_self"):(s.buffer(e.mdContent),t.history.back())},this["new"]=function(){t.open("main.html#/edit","_self")}}]),String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)};